{"version":3,"file":"chartogram.js","sources":["../modules/utility.js","../modules/Chartogram.js","../modules/index.js"],"sourcesContent":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nexport function clearElement(element) {\n  while (element.firstChild) {\n    element.removeChild(element.firstChild);\n  }\n}\nexport function commaJoin(a, b) {\n  return a.map(function (ai, i) {\n    return \"\".concat(ai, \",\").concat(b[i]);\n  });\n}\nexport function getLowerSiblingDivisibleBy(n, divider) {\n  n = Math.floor(n);\n\n  while (true) {\n    if (n < divider) {\n      return divider;\n    }\n\n    if (n % divider === 0) {\n      return n;\n    }\n\n    n--;\n  }\n}\nexport function divideInterval(min, max, GAUGE_TICK_MARKS_COUNT) {\n  var points = new Array(GAUGE_TICK_MARKS_COUNT);\n  var i = 0;\n\n  while (i < GAUGE_TICK_MARKS_COUNT) {\n    points[i] = min + i * (max - min) / (GAUGE_TICK_MARKS_COUNT - 1);\n    i++;\n  }\n\n  return points;\n}\nexport function renderGaugeLabels(element, min, max, GAUGE_TICK_MARKS_COUNT, transform) {\n  var i = 0;\n\n  while (i < GAUGE_TICK_MARKS_COUNT) {\n    var tickMark = document.createElement('div');\n    var value = min + i * (max - min) / (GAUGE_TICK_MARKS_COUNT - 1);\n\n    if (transform) {\n      value = transform(value);\n    }\n\n    tickMark.appendChild(document.createTextNode(value));\n    element.appendChild(tickMark);\n    i++;\n  }\n}\nexport function throttle(func, interval) {\n  var timeout;\n  var executedAt = 0;\n\n  var scheduled = function scheduled() {\n    timeout = undefined;\n    executedAt = Date.now();\n    func();\n  };\n\n  return function () {\n    var now = Date.now();\n    var remaining = interval - (now - executedAt);\n\n    if (remaining <= 0) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = undefined;\n      }\n\n      executedAt = now;\n      func();\n    } else if (!timeout) {\n      timeout = setTimeout(scheduled, remaining);\n    }\n  };\n}\nexport function simplifyGraph(x, y, maxPoints) {\n  var yMax = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Math.max.apply(Math, _toConsumableArray(y));\n  var threshold = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0.025;\n  var i = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n\n  var _x = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new Array(x.length);\n\n  var _y = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : new Array(x.length);\n\n  var _i = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 0;\n\n  if (i + 2 > x.length - 1) {\n    while (i < y.length) {\n      _x[_i] = x[i];\n      _y[_i] = y[i];\n      _i++;\n      i++;\n    }\n\n    _x = _x.slice(0, _i);\n    _y = _y.slice(0, _i);\n\n    if (_x.length <= maxPoints) {\n      return [_x, _y];\n    } else {\n      if (x.length / _x.length < 1.1) {\n        threshold = Math.min(threshold + 0.025, 1);\n      }\n\n      return simplifyGraph(_x, _y, maxPoints, yMax, threshold);\n    }\n  }\n\n  var y0 = (y[i + 2] + y[i]) / 2;\n\n  if (Math.abs(y0 - y[i + 1]) / yMax < threshold) {\n    _x[_i] = x[i];\n    _x[_i + 1] = x[i + 2];\n    _y[_i] = y[i];\n    _y[_i + 1] = y[i + 2];\n    return simplifyGraph(x, y, maxPoints, yMax, threshold, i + 2, _x, _y, _i + 1);\n  } else {\n    _x[_i] = x[i];\n    _x[_i + 1] = x[i + 1];\n    _x[_i + 2] = x[i + 2];\n    _y[_i] = y[i];\n    _y[_i + 1] = y[i + 1];\n    _y[_i + 2] = y[i + 2];\n    return simplifyGraph(x, y, maxPoints, yMax, threshold, i + 2, _x, _y, _i + 2);\n  }\n}\nexport function setUpDrag(element, onDragStart, onDrag) {\n  function onTouchMove(event) {\n    onDrag(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  function onPointerMove(event) {\n    onDrag(event.clientX, event.clientY);\n  }\n\n  function onDragStop() {\n    window.removeEventListener('pointermove', onPointerMove);\n    window.removeEventListener('touchmove', onTouchMove);\n    window.removeEventListener('pointerup', onDragStop);\n    window.removeEventListener('pointercancel', onDragStop);\n    window.removeEventListener('touchend', onDragStop);\n    window.removeEventListener('touchcancel', onDragStop);\n  }\n\n  function onTouchStart(event) {\n    // Ignore multitouch.\n    if (event.touches.length > 1) {\n      // Reset.\n      return onDragStop();\n    }\n\n    onDragStart(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n    window.addEventListener('touchmove', onTouchMove);\n    window.addEventListener('touchend', onDragStop);\n    window.addEventListener('touchcancel', onDragStop);\n  } // Safari doesn't support pointer events.\n  // https://caniuse.com/#feat=pointer\n\n\n  element.addEventListener('touchstart', onTouchStart);\n\n  function onPointerDown(event) {\n    onDragStart(event.clientX, event.clientY);\n    window.addEventListener('pointermove', onPointerMove);\n    window.addEventListener('pointerup', onDragStop);\n    window.addEventListener('pointercancel', onDragStop);\n  }\n\n  element.addEventListener('pointerdown', onPointerDown);\n  return function () {\n    onDragStop();\n    element.removeEventListener(onPointerDown);\n    element.removeEventListener(onTouchStart);\n  };\n}\n//# sourceMappingURL=utility.js.map","function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { clearElement, commaJoin, getLowerSiblingDivisibleBy, divideInterval, renderGaugeLabels, throttle, simplifyGraph, setUpDrag } from './utility';\n\nvar Chartogram =\n/*#__PURE__*/\nfunction () {\n  function Chartogram(rootNode, data) {\n    var _this = this;\n\n    var title = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'Title';\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    _classCallCheck(this, Chartogram);\n\n    _defineProperty(this, \"onResize\", function (event) {\n      _this.setState({\n        aspectRatio: _this.getCanvasAspectRatio(),\n        timelineAspectRatio: _this.getTimelineCanvasAspectRatio()\n      });\n    });\n\n    _defineProperty(this, \"onResizeThrottled\", throttle(this.onResize, 33));\n\n    _defineProperty(this, \"fixSvgCoordinate\", function (x) {\n      var precisionFactor = _this.props.precisionFactor;\n      return Math.round(x * precisionFactor) / precisionFactor;\n    });\n\n    _defineProperty(this, \"mapX\", function (x) {\n      var canvasWidth = _this.props.canvasWidth;\n      var _this$state = _this.state,\n          minX = _this$state.minX,\n          maxX = _this$state.maxX;\n      return (x - minX) / (maxX - minX) * canvasWidth;\n    });\n\n    _defineProperty(this, \"mapY\", function (y) {\n      var canvasWidth = _this.props.canvasWidth;\n      var _this$state2 = _this.state,\n          minY = _this$state2.minY,\n          maxY = _this$state2.maxY,\n          aspectRatio = _this$state2.aspectRatio;\n      return (y - minY) / (maxY - minY) * canvasWidth / aspectRatio;\n    });\n\n    _defineProperty(this, \"mapXForTimeline\", function (x) {\n      var canvasWidth = _this.props.canvasWidth;\n      var _this$data = _this.data,\n          minX = _this$data.minX,\n          maxX = _this$data.maxX;\n      return (x - minX) / (maxX - minX) * canvasWidth;\n    });\n\n    _defineProperty(this, \"mapYForTimeline\", function (y) {\n      var canvasWidth = _this.props.canvasWidth;\n      var _this$state3 = _this.state,\n          minYGlobal = _this$state3.minYGlobal,\n          maxYGlobal = _this$state3.maxYGlobal,\n          timelineAspectRatio = _this$state3.timelineAspectRatio;\n      return (y - minYGlobal) / (maxYGlobal - minYGlobal) * canvasWidth / timelineAspectRatio;\n    });\n\n    _defineProperty(this, \"createGridLine\", function (y) {\n      var _this$state4 = _this.state,\n          minX = _this$state4.minX,\n          maxX = _this$state4.maxX,\n          minY = _this$state4.minY,\n          maxY = _this$state4.maxY,\n          yScale = _this$state4.yScale;\n      var line = document.createElement('line');\n      line.classList.add('chartogram__grid-line');\n      line.setAttribute('x1', _this.fixSvgCoordinate(_this.mapX(minX)));\n      line.setAttribute('x2', _this.fixSvgCoordinate(_this.mapX(maxX)));\n      line.setAttribute('y1', _this.fixSvgCoordinate(_this.mapY(maxY - yScale * y)));\n      line.setAttribute('y2', _this.fixSvgCoordinate(_this.mapY(maxY - yScale * y)));\n      return line;\n    });\n\n    _defineProperty(this, \"drawGauges\", function (minX, maxX, minY, maxY, yAxisScale) {\n      var _this$props = _this.props,\n          gaugeTickMarksCount = _this$props.gaugeTickMarksCount,\n          months = _this$props.months;\n      clearElement(_this.xAxis);\n      clearElement(_this.yAxis);\n      renderGaugeLabels(_this.xAxis, minX, maxX, gaugeTickMarksCount, function (timestamp) {\n        var date = new Date(timestamp);\n        return \"\".concat(months[date.getMonth()], \" \").concat(date.getDate());\n      });\n      renderGaugeLabels(_this.yAxis, minY, maxY, gaugeTickMarksCount);\n      _this.yAxis.style.height = \"\".concat(100 / yAxisScale, \"%\");\n    });\n\n    _defineProperty(this, \"renderTimeline\", function () {\n      var canvasWidth = _this.props.canvasWidth;\n      var _this$data2 = _this.data,\n          x = _this$data2.x,\n          y = _this$data2.y;\n      var _this$state5 = _this.state,\n          timelineAspectRatio = _this$state5.timelineAspectRatio,\n          maxYGlobal = _this$state5.maxYGlobal,\n          yScale = _this$state5.yScale; // Clear canvas.\n\n      clearElement(_this.timelineCanvas); // Set canvas `viewBox`.\n\n      _this.timelineCanvas.setAttribute('viewBox', \"0 0 \".concat(canvasWidth, \" \").concat(_this.fixSvgCoordinate(canvasWidth / timelineAspectRatio)));\n\n      var _loop = function _loop() {\n        if (_isArray) {\n          if (_i >= _iterator.length) return \"break\";\n          _ref = _iterator[_i++];\n        } else {\n          _i = _iterator.next();\n          if (_i.done) return \"break\";\n          _ref = _i.value;\n        }\n\n        var _ref2 = _ref,\n            id = _ref2.id,\n            color = _ref2.color,\n            points = _ref2.points;\n\n        var isShown = _this.state.y.find(function (_) {\n          return _.id === id;\n        }).isShown;\n\n        if (isShown) {\n          var _simplifyGraph = simplifyGraph(x.points, points, 80),\n              _simplifyGraph2 = _slicedToArray(_simplifyGraph, 2),\n              _x = _simplifyGraph2[0],\n              _y = _simplifyGraph2[1];\n\n          var graph = document.createElement('polyline');\n          graph.setAttribute('stroke', color);\n          graph.setAttribute('points', _this.createPolylinePoints(_x.map(_this.mapXForTimeline), _y.map(function (y) {\n            return _this.mapYForTimeline(maxYGlobal - y * yScale);\n          })).join(' '));\n          graph.classList.add('chartogram__graph');\n\n          _this.timelineCanvas.appendChild(graph);\n        }\n      };\n\n      for (var _iterator = y, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n        var _ref;\n\n        var _ret = _loop();\n\n        if (_ret === \"break\") break;\n      } // A workaround to fix WebKit bug when it's not re-rendering the <svg/>.\n      // https://stackoverflow.com/questions/30905493/how-to-force-webkit-to-update-svg-use-elements-after-changes-to-original\n\n\n      _this.timelineCanvas.innerHTML += '';\n    });\n\n    _defineProperty(this, \"createGraphToggler\", function (_ref3) {\n      var id = _ref3.id,\n          name = _ref3.name,\n          color = _ref3.color;\n      var toggler = document.createElement('button');\n      toggler.setAttribute('type', 'button');\n      toggler.classList.add('chartogram__chart-toggler');\n      toggler.classList.add('chartogram__chart-toggler--on');\n      toggler.classList.add('chartogram__reset-button'); // Add check.\n\n      var xmlns = 'http://www.w3.org/2000/svg';\n      var check = document.createElementNS(xmlns, 'svg');\n      check.setAttribute('viewBox', '0 0 19 19');\n      check.setAttribute('class', 'chartogram__chart-toggler-check'); // Add background circle.\n\n      var backgroundCircle = document.createElementNS(xmlns, 'circle');\n      backgroundCircle.setAttribute('cx', '9.5');\n      backgroundCircle.setAttribute('cy', '9.5');\n      backgroundCircle.setAttribute('r', '9.5');\n      backgroundCircle.setAttribute('fill', color);\n      check.appendChild(backgroundCircle); // Add check circle.\n\n      var checkCircle = document.createElementNS(xmlns, 'circle');\n      checkCircle.setAttribute('cx', '9.5');\n      checkCircle.setAttribute('cy', '9.5');\n      checkCircle.setAttribute('r', '8');\n      checkCircle.setAttribute('class', 'chartogram__chart-toggler-check-circle');\n      check.appendChild(checkCircle); // Add check mark.\n\n      var checkMark = document.createElementNS(xmlns, 'path');\n      checkMark.setAttribute('d', 'M13.64 4.94l-6.2 6.34-1.69-1.9c-.73-.63-1.89.1-1.36 1.06l2 3.38c.3.43 1.04.85 1.78 0 .32-.42 6.31-7.93 6.31-7.93.74-.84-.2-1.58-.84-.95z');\n      checkMark.setAttribute('fill', 'white');\n      checkMark.setAttribute('class', 'chartogram__chart-toggler-check-mark');\n      check.appendChild(checkMark); // Add checkmark.\n\n      toggler.appendChild(check); // Add graph name.\n\n      toggler.appendChild(document.createTextNode(name)); // On click.\n\n      toggler.addEventListener('click', function () {\n        var y = _this.state.y.find(function (_) {\n          return _.id === id;\n        }); // Won't allow hiding all graphs.\n\n\n        if (y.isShown) {\n          var graphsShown = _this.state.y.filter(function (_) {\n            return _.isShown;\n          });\n\n          if (graphsShown.length === 1) {\n            return;\n          }\n        }\n\n        y.isShown = !y.isShown;\n\n        _this.setState(_objectSpread({}, _this.state, _this.calculateMinMaxY(_this.state.y)));\n\n        toggler.classList.toggle('chartogram__chart-toggler--on');\n      });\n      return toggler;\n    });\n\n    _defineProperty(this, \"setUpTimelineWindowHandle\", function (side) {\n      var handle = side === 'left' ? _this.timelineWindowLeftHandle : _this.timelineWindowRightHandle;\n      var handleWidth = parseFloat(getComputedStyle(_this.timelineWindow).borderLeftWidth);\n      var timelineCoordinates;\n      var minX;\n      var maxX;\n      var deltaX;\n      var startedX;\n\n      var onDrag = function onDrag(x) {\n        x -= deltaX;\n        x = Math.max(Math.min(x, maxX), minX);\n        var ratio = (x - timelineCoordinates.left) / timelineCoordinates.width;\n\n        if (side === 'left') {\n          _this.updateBounds(ratio, _this.state.toRatio);\n        } else {\n          _this.updateBounds(_this.state.fromRatio, ratio);\n        }\n      };\n\n      var onDragStart = function onDragStart(x) {\n        timelineCoordinates = _this.timeline.getBoundingClientRect();\n\n        var timelineWindowCoordinates = _this.timelineWindow.getBoundingClientRect();\n\n        if (side === 'left') {\n          minX = timelineCoordinates.left;\n          maxX = timelineWindowCoordinates.left + timelineWindowCoordinates.width - 2 * handleWidth;\n          deltaX = x - timelineWindowCoordinates.left;\n        } else {\n          minX = timelineWindowCoordinates.left + 2 * handleWidth;\n          maxX = timelineCoordinates.left + timelineCoordinates.width;\n          deltaX = x - (timelineWindowCoordinates.left + timelineWindowCoordinates.width);\n        }\n      };\n\n      return setUpDrag(handle, onDragStart, onDrag);\n    });\n\n    _defineProperty(this, \"setUpTimelineWindow\", function () {\n      var timelineCoordinates;\n      var timelineWindowCoordinates;\n      var minX;\n      var maxX;\n      var innerX;\n\n      var onDrag = function onDrag(x) {\n        x -= innerX;\n        x = Math.max(Math.min(x, maxX), minX);\n        var ratio = (x - timelineCoordinates.left) / timelineCoordinates.width;\n\n        _this.updateBounds(ratio, ratio + timelineWindowCoordinates.width / timelineCoordinates.width);\n      };\n\n      var onDragStart = function onDragStart(x) {\n        timelineCoordinates = _this.timeline.getBoundingClientRect();\n        timelineWindowCoordinates = _this.timelineWindow.getBoundingClientRect();\n        innerX = x - timelineWindowCoordinates.left;\n        minX = timelineCoordinates.left;\n        maxX = timelineCoordinates.left + (timelineCoordinates.width - timelineWindowCoordinates.width);\n      };\n\n      return setUpDrag(_this.timelineWindowDrag, onDragStart, onDrag);\n    });\n\n    _defineProperty(this, \"setTimelineWindowLeft\", function (ratio) {\n      _this.timelineOverlayLeft.style.right = \"\".concat(100 * (1 - ratio), \"%\");\n      _this.timelineWindow.style.left = \"\".concat(100 * ratio, \"%\");\n    });\n\n    _defineProperty(this, \"setTimelineWindowRight\", function (ratio) {\n      _this.timelineOverlayRight.style.left = \"\".concat(100 * ratio, \"%\");\n      _this.timelineWindow.style.right = \"\".concat(100 * (1 - ratio), \"%\");\n    });\n\n    _defineProperty(this, \"setUpCanvasTooltipListener\", function () {\n      var _this$props2 = _this.props,\n          weekdays = _this$props2.weekdays,\n          months = _this$props2.months;\n      var canvasDimensions;\n      var isIndexInBounds;\n\n      var onTrack = function onTrack(screenX) {\n        var _this$state6 = _this.state,\n            minX = _this$state6.minX,\n            maxX = _this$state6.maxX,\n            xPoints = _this$state6.xPoints,\n            y = _this$state6.y;\n        var xScreenRatio = (screenX - canvasDimensions.left) / canvasDimensions.width;\n        var xPoint = minX + xScreenRatio * (maxX - minX);\n        var xHigherIndex = xPoints.findIndex(function (_) {\n          return _ >= xPoint;\n        });\n        var xLowerIndex = xHigherIndex - 1;\n\n        if (!isIndexInBounds(xHigherIndex)) {\n          xHigherIndex = -1;\n        }\n\n        if (!isIndexInBounds(xLowerIndex)) {\n          xLowerIndex = -1;\n        }\n\n        var xIndex;\n\n        if (xHigherIndex < 0) {\n          if (xLowerIndex < 0) {\n            return _this.removeTooltip();\n          } else {\n            xIndex = xLowerIndex;\n          }\n        } else {\n          if (xLowerIndex < 0) {\n            xIndex = xHigherIndex;\n          } else {\n            var xLower = xPoints[xLowerIndex];\n            var xHigher = xPoints[xHigherIndex];\n            var deltaLower = xPoint - xLower;\n            var deltaHigher = xHigher - xPoint;\n            xIndex = deltaLower > deltaHigher ? xHigherIndex : xLowerIndex;\n          }\n        }\n\n        var x = xPoints[xIndex];\n\n        if (x !== _this.tooltipForX) {\n          _this.tooltipForX = x;\n\n          if (!_this.tooltip) {\n            _this.addTooltip();\n          }\n\n          var date = new Date(x);\n          _this.tooltipDate.textContent = \"\".concat(weekdays[date.getDay()], \", \").concat(months[date.getMonth()], \" \").concat(date.getDate());\n          var i = 0;\n\n          for (var _iterator2 = y, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n            var _ref4;\n\n            if (_isArray2) {\n              if (_i2 >= _iterator2.length) break;\n              _ref4 = _iterator2[_i2++];\n            } else {\n              _i2 = _iterator2.next();\n              if (_i2.done) break;\n              _ref4 = _i2.value;\n            }\n\n            var _ref5 = _ref4,\n                isShown = _ref5.isShown,\n                points = _ref5.points,\n                name = _ref5.name;\n\n            if (isShown) {\n              _this.tooltipValues.childNodes[2 * i].textContent = points[xIndex];\n              _this.tooltipValues.childNodes[2 * i + 1].textContent = name;\n              i++;\n            }\n          }\n\n          var xRatio = (x - minX) / (maxX - minX);\n          _this.tooltip.style.left = \"\".concat(xRatio * 100, \"%\");\n\n          _this.updateTooltipPoints(xIndex, xRatio);\n\n          _this.updateTooltipLine(x);\n        }\n      };\n\n      var onTrackStart = function onTrackStart() {\n        canvasDimensions = _this.canvas.getBoundingClientRect();\n\n        isIndexInBounds = function isIndexInBounds(index) {\n          var xPoints = _this.state.xPoints;\n          return index >= 0 && index < xPoints.length;\n        };\n      };\n\n      var onTouchStart = function onTouchStart(event) {\n        // Ignore multitouch.\n        if (event.touches.length > 1) {\n          // Reset.\n          return onTrackStop();\n        }\n\n        onTrackStart();\n\n        _this.canvas.addEventListener('touchend', onTrackStop);\n\n        _this.canvas.addEventListener('touchmove', onTouchMove);\n\n        _this.canvas.addEventListener('touchend', onTrackStop);\n\n        _this.canvas.addEventListener('touchcancel', onTrackStop);\n\n        onTouchMove(event);\n      }; // Safari doesn't support pointer events.\n      // https://caniuse.com/#feat=pointer\n\n\n      _this.canvas.addEventListener('touchstart', onTouchStart);\n\n      function onTouchMove(event) {\n        var x = event.changedTouches[0].clientX;\n        var y = event.changedTouches[0].clientY; // Emulate 'pointerleave' behavior.\n\n        if (x < canvasDimensions.left || x > canvasDimensions.left + canvasDimensions.width || y < canvasDimensions.top || y > canvasDimensions.top + canvasDimensions.height) {\n          onTrackStop();\n        } else {\n          onTrack(x, y);\n        }\n      }\n\n      function onPointerMove(event) {\n        onTrack(event.clientX, event.clientY);\n      }\n\n      var onTrackStop = function onTrackStop() {\n        _this.canvas.removeEventListener('pointermove', onPointerMove);\n\n        _this.canvas.removeEventListener('pointerleave', onTrackStop);\n\n        _this.canvas.removeEventListener('pointercancel', onTrackStop);\n\n        _this.canvas.removeEventListener('touchmove', onTouchMove);\n\n        _this.canvas.removeEventListener('touchend', onTrackStop);\n\n        _this.canvas.removeEventListener('touchcancel', onTrackStop);\n\n        _this.removeTooltip();\n      };\n\n      var onPointerEnter = function onPointerEnter() {\n        onTrackStart();\n\n        _this.canvas.addEventListener('pointermove', onPointerMove);\n\n        _this.canvas.addEventListener('pointerleave', onTrackStop);\n\n        _this.canvas.addEventListener('pointercancel', onTrackStop);\n      };\n\n      _this.canvas.addEventListener('pointerenter', onPointerEnter);\n\n      return function () {\n        onTrackStop();\n\n        _this.canvas.removeEventListener(onPointerEnter);\n\n        _this.canvas.removeEventListener(onTouchStart);\n      };\n    });\n\n    _defineProperty(this, \"addTooltip\", function () {\n      var y = _this.state.y; // Create tooltip.\n\n      _this.tooltip = document.createElement('div');\n\n      _this.tooltip.classList.add('chartogram__tooltip');\n\n      _this.tooltipContainer.appendChild(_this.tooltip); // Add tooltip title.\n\n\n      _this.tooltipDate = document.createElement('h1');\n\n      _this.tooltipDate.classList.add('chartogram__tooltip-header');\n\n      _this.tooltip.appendChild(_this.tooltipDate); // Add graph values.\n\n\n      _this.tooltipValues = document.createElement('dl');\n\n      _this.tooltipValues.classList.add('chartogram__tooltip-values');\n\n      _this.tooltip.appendChild(_this.tooltipValues); // Add graph values.\n\n\n      for (var _iterator3 = y, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n        var _ref6;\n\n        if (_isArray3) {\n          if (_i3 >= _iterator3.length) break;\n          _ref6 = _iterator3[_i3++];\n        } else {\n          _i3 = _iterator3.next();\n          if (_i3.done) break;\n          _ref6 = _i3.value;\n        }\n\n        var _ref7 = _ref6,\n            isShown = _ref7.isShown,\n            color = _ref7.color;\n\n        if (isShown) {\n          // Add graph value.\n          var tooltipValue = document.createElement('dt');\n          tooltipValue.style.color = color;\n\n          _this.tooltipValues.appendChild(tooltipValue); // Add graph name.\n\n\n          var tooltipName = document.createElement('dd');\n          tooltipName.style.color = color;\n\n          _this.tooltipValues.appendChild(tooltipName);\n        }\n      }\n    });\n\n    _defineProperty(this, \"addTooltipLine\", function () {\n      var xmlns = 'http://www.w3.org/2000/svg';\n      _this.tooltipLine = document.createElementNS(xmlns, 'line');\n\n      _this.tooltipLine.setAttributeNS(null, 'class', 'chartogram__tooltip-line');\n\n      _this.canvas.insertBefore(_this.tooltipLine, _this.canvas.querySelector('polyline'));\n    });\n\n    _defineProperty(this, \"removeTooltip\", function () {\n      if (_this.tooltip) {\n        _this.tooltipForX = undefined;\n\n        _this.tooltipContainer.removeChild(_this.tooltip);\n\n        _this.tooltip = undefined;\n\n        _this.removeTooltipPoints();\n\n        _this.removeTooltipLine();\n      }\n    });\n\n    _defineProperty(this, \"removeTooltipLine\", function () {\n      _this.canvas.removeChild(_this.tooltipLine);\n\n      _this.tooltipLine = undefined;\n    });\n\n    _defineProperty(this, \"addTooltipPoints\", function () {\n      _this.tooltipPoints = [];\n\n      for (var _iterator4 = _this.state.y, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n        var _ref8;\n\n        if (_isArray4) {\n          if (_i4 >= _iterator4.length) break;\n          _ref8 = _iterator4[_i4++];\n        } else {\n          _i4 = _iterator4.next();\n          if (_i4.done) break;\n          _ref8 = _i4.value;\n        }\n\n        var y = _ref8;\n\n        if (y.isShown) {\n          var point = document.createElement('div');\n          point.classList.add('chartogram__tooltip-point');\n          point.style.color = y.color;\n\n          _this.tooltipPoints.push(point);\n\n          _this.canvasWrapper.appendChild(point);\n        }\n      }\n    });\n\n    _defineProperty(this, \"removeTooltipPoints\", function () {\n      for (var _iterator5 = _this.tooltipPoints, _isArray5 = Array.isArray(_iterator5), _i5 = 0, _iterator5 = _isArray5 ? _iterator5 : _iterator5[Symbol.iterator]();;) {\n        var _ref9;\n\n        if (_isArray5) {\n          if (_i5 >= _iterator5.length) break;\n          _ref9 = _iterator5[_i5++];\n        } else {\n          _i5 = _iterator5.next();\n          if (_i5.done) break;\n          _ref9 = _i5.value;\n        }\n\n        var point = _ref9;\n\n        _this.canvasWrapper.removeChild(point);\n      }\n\n      _this.tooltipPoints = undefined;\n    });\n\n    _defineProperty(this, \"updateTooltipLine\", function (x) {\n      var canvasWidth = _this.props.canvasWidth;\n      var aspectRatio = _this.state.aspectRatio;\n\n      if (!_this.tooltipLine) {\n        _this.addTooltipLine();\n      }\n\n      _this.tooltipLine.setAttributeNS(null, 'x1', _this.fixSvgCoordinate(_this.mapX(x)));\n\n      _this.tooltipLine.setAttributeNS(null, 'x2', _this.fixSvgCoordinate(_this.mapX(x)));\n\n      _this.tooltipLine.setAttributeNS(null, 'y1', 0);\n\n      _this.tooltipLine.setAttributeNS(null, 'y2', _this.fixSvgCoordinate(canvasWidth / aspectRatio));\n    });\n\n    _defineProperty(this, \"updateTooltipPoints\", function (xIndex, xRatio) {\n      var _this$state7 = _this.state,\n          maxY = _this$state7.maxY,\n          y = _this$state7.y;\n\n      if (!_this.tooltipPoints) {\n        _this.addTooltipPoints();\n      }\n\n      var i = 0;\n\n      while (i < _this.tooltipPoints.length) {\n        var point = _this.tooltipPoints[i];\n        var _y = y[i].points[xIndex];\n        var yRatio = _y / maxY;\n        point.style.left = \"\".concat(xRatio * 100, \"%\");\n        point.style.bottom = \"\".concat(yRatio * 100, \"%\");\n        i++;\n      }\n    });\n\n    this.props = _objectSpread({\n      title: title,\n      gaugeTickMarksCount: 6,\n      timelineWindowSize: 40,\n      canvasWidth: 512,\n      precisionFactor: Math.pow(10, options.precision || 3),\n      months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n      weekdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    }, options);\n    this.rootNode = rootNode;\n    this.data = _objectSpread({}, data, {\n      minX: Math.min.apply(Math, _toConsumableArray(data.x.points)),\n      maxX: Math.max.apply(Math, _toConsumableArray(data.x.points)),\n      y: data.y.map(function (y) {\n        return _objectSpread({}, y, {\n          min: Math.min.apply(Math, _toConsumableArray(y.points)),\n          max: Math.max.apply(Math, _toConsumableArray(y.points))\n        });\n      })\n    });\n  }\n\n  _createClass(Chartogram, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.rootNode.classList.add('chartogram');\n      this.rootNode.innerHTML = \"\\n\\t\\t\\t<header class=\\\"chartogram__header\\\">\\n\\t\\t\\t\\t<h1 class=\\\"chartogram__title\\\">\".concat(this.props.title, \"</h1>\\n\\t\\t\\t</header>\\n\\t\\t\\t<div class=\\\"chartogram__plan-with-axes\\\">\\n\\t\\t\\t\\t<div class=\\\"chartogram__plan\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"chartogram__top-border\\\"></div>\\n\\t\\t\\t\\t\\t<div class=\\\"chartogram__canvas-wrapper\\\">\\n\\t\\t\\t\\t\\t\\t<svg class=\\\"chartogram__canvas\\\"></svg>\\n\\t\\t\\t\\t\\t\\t<div class=\\\"chartogram__x\\\"></div>\\n\\t\\t\\t\\t\\t\\t<div class=\\\"chartogram__y-wrapper\\\">\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\\"chartogram__y\\\"></div>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\\\"chartogram__timeline\\\">\\n\\t\\t\\t\\t<div class=\\\"chartogram__timeline-canvas-padding\\\">\\n\\t\\t\\t\\t\\t<svg class=\\\"chartogram__timeline-canvas\\\" preserveAspectRatio=\\\"none\\\"></svg>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div class=\\\"chartogram__timeline-overlay-left\\\"></div>\\n\\t\\t\\t\\t<div class=\\\"chartogram__timeline-overlay-right\\\"></div>\\n\\t\\t\\t\\t<div class=\\\"chartogram__timeline-window\\\">\\n\\t\\t\\t\\t\\t<button type=\\\"button\\\" class=\\\"chartogram__reset-button chartogram__timeline-window__drag\\\"></button>\\n\\t\\t\\t\\t\\t<button type=\\\"button\\\" class=\\\"chartogram__reset-button chartogram__timeline-window__left-handle\\\"></button>\\n\\t\\t\\t\\t\\t<button type=\\\"button\\\" class=\\\"chartogram__reset-button chartogram__timeline-window__right-handle\\\"></button>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\\\"chartogram__chart-togglers\\\"></div>\\n\\t\\t\");\n      this.tooltipContainer = this.rootNode.querySelector('.chartogram__plan');\n      this.canvas = this.rootNode.querySelector('.chartogram__canvas');\n      this.canvasWrapper = this.rootNode.querySelector('.chartogram__canvas-wrapper');\n      this.xAxis = this.rootNode.querySelector('.chartogram__x');\n      this.yAxis = this.rootNode.querySelector('.chartogram__y');\n      this.timeline = this.rootNode.querySelector('.chartogram__timeline');\n      this.timelineOverlayLeft = this.rootNode.querySelector('.chartogram__timeline-overlay-left');\n      this.timelineWindowLeftHandle = this.rootNode.querySelector('.chartogram__timeline-window__left-handle');\n      this.timelineWindow = this.rootNode.querySelector('.chartogram__timeline-window');\n      this.timelineWindowDrag = this.rootNode.querySelector('.chartogram__timeline-window__drag');\n      this.timelineWindowRightHandle = this.rootNode.querySelector('.chartogram__timeline-window__right-handle');\n      this.timelineOverlayRight = this.rootNode.querySelector('.chartogram__timeline-overlay-right');\n      this.timelineCanvas = this.rootNode.querySelector('.chartogram__timeline-canvas');\n      this.setUpTimelineWindowHandle('left');\n      this.setUpTimelineWindowHandle('right');\n      this.setUpTimelineWindow();\n      this.setUpCanvasTooltipListener(); // Add graph togglers.\n\n      var graphTogglers = this.rootNode.querySelector('.chartogram__chart-togglers');\n      clearElement(graphTogglers);\n\n      for (var _iterator6 = this.data.y, _isArray6 = Array.isArray(_iterator6), _i6 = 0, _iterator6 = _isArray6 ? _iterator6 : _iterator6[Symbol.iterator]();;) {\n        var _ref10;\n\n        if (_isArray6) {\n          if (_i6 >= _iterator6.length) break;\n          _ref10 = _iterator6[_i6++];\n        } else {\n          _i6 = _iterator6.next();\n          if (_i6.done) break;\n          _ref10 = _i6.value;\n        }\n\n        var y = _ref10;\n        graphTogglers.appendChild(this.createGraphToggler(y));\n      } // Render will be called after `.componentDidMount()`.\n\n\n      this.state = this.getInitialState();\n      this.updateTimelineBounds(this.state.fromRatio, this.state.toRatio); // Add window resize event listener.\n\n      window.addEventListener('resize', this.onResizeThrottled);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // Remove window resize event listener.\n      window.removeEventListener('resize', this.onResizeThrottled);\n    }\n  }, {\n    key: \"getCanvasAspectRatio\",\n    value: function getCanvasAspectRatio() {\n      var canvasDimensions = this.canvas.getBoundingClientRect();\n      return canvasDimensions.width / canvasDimensions.height;\n    }\n  }, {\n    key: \"getTimelineCanvasAspectRatio\",\n    value: function getTimelineCanvasAspectRatio() {\n      var timelineCanvasDimensions = this.timelineCanvas.getBoundingClientRect();\n      return timelineCanvasDimensions.width / timelineCanvasDimensions.height;\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(newState, renderTimeline) {\n      this.state = _objectSpread({}, this.state, newState);\n      this.render(renderTimeline);\n    }\n  }, {\n    key: \"getInitialState\",\n    value: function getInitialState() {\n      var timelineWindowSize = this.props.timelineWindowSize;\n      var _this$data3 = this.data,\n          minX = _this$data3.minX,\n          maxX = _this$data3.maxX;\n      var fromIndex;\n\n      if (this.data.x.points.length > timelineWindowSize) {\n        fromIndex = this.data.x.points.length - timelineWindowSize;\n      } else {\n        fromIndex = 0;\n      }\n\n      var xFrom = this.data.x.points[fromIndex];\n      var fromRatio = (xFrom - minX) / (maxX - minX);\n      var toRatio = 1;\n      return _objectSpread({}, this.createState(fromRatio, toRatio), {\n        aspectRatio: this.getCanvasAspectRatio(),\n        timelineAspectRatio: this.getTimelineCanvasAspectRatio(),\n        yScale: 1\n      });\n    }\n  }, {\n    key: \"createState\",\n    value: function createState(fromRatio, toRatio) {\n      var _this2 = this;\n\n      var x = this.data.x;\n      var minX = this.data.minX + fromRatio * (this.data.maxX - this.data.minX);\n      var maxX = this.data.minX + toRatio * (this.data.maxX - this.data.minX);\n      var fromIndex;\n\n      if (minX === this.data.minX) {\n        fromIndex = 0;\n      } else {\n        fromIndex = x.points.findIndex(function (x) {\n          return x > minX;\n        }) - 1;\n      }\n\n      var toIndex;\n\n      if (maxX === this.data.maxX) {\n        toIndex = x.points.length - 1;\n      } else {\n        toIndex = x.points.findIndex(function (x) {\n          return x > maxX;\n        });\n      }\n\n      var xPoints = x.points.slice(fromIndex, toIndex + 1);\n      var xGraphPoints = xPoints.slice(); // Create X graph points.\n\n      if (xPoints.length >= 2) {\n        if (x.points[fromIndex] !== minX) {\n          xGraphPoints[0] = minX;\n        }\n\n        if (x.points[toIndex] !== maxX) {\n          xGraphPoints[xGraphPoints.length - 1] = maxX;\n        }\n      }\n\n      var y = this.data.y.map(function (y, i) {\n        var points = _this2.data.y[i].points.slice(fromIndex, toIndex + 1);\n\n        var graphPoints = points.slice();\n\n        if (xPoints.length >= 2) {\n          if (x.points[fromIndex] !== minX) {\n            var beforeStartY = _this2.data.y[i].points[fromIndex];\n            var startY = _this2.data.y[i].points[fromIndex + 1];\n            var fromXExcludedTickRatio = (minX - _this2.data.x.points[fromIndex]) / (_this2.data.x.points[fromIndex + 1] - _this2.data.x.points[fromIndex]);\n            var startPoint = beforeStartY + (startY - beforeStartY) * fromXExcludedTickRatio;\n            graphPoints[0] = startPoint;\n          }\n\n          if (x.points[toIndex] !== maxX) {\n            var afterEndY = _this2.data.y[i].points[toIndex];\n            var endY = _this2.data.y[i].points[toIndex - 1];\n            var toXIncludedTickRatio = (maxX - _this2.data.x.points[toIndex - 1]) / (_this2.data.x.points[toIndex] - _this2.data.x.points[toIndex - 1]);\n            var endPoint = endY + (afterEndY - endY) * toXIncludedTickRatio;\n            graphPoints[graphPoints.length - 1] = endPoint;\n          }\n        }\n\n        return _objectSpread({}, _this2.data.y[i], _this2.state ? _this2.state.y[i] : {\n          isShown: true\n        }, {\n          points: points,\n          graphPoints: graphPoints,\n          // Min Y is always 0 by design.\n          min: 0,\n          // min: Math.min(...graphPoints),\n          max: Math.max.apply(Math, _toConsumableArray(graphPoints))\n        });\n      });\n      return _objectSpread({\n        minX: minX,\n        maxX: maxX,\n        fromIndex: fromIndex,\n        toIndex: toIndex,\n        fromRatio: fromRatio,\n        toRatio: toRatio,\n        xPoints: xPoints,\n        xGraphPoints: xGraphPoints\n      }, this.calculateMinMaxY(y), {\n        y: y\n      });\n    }\n  }, {\n    key: \"calculateMinMaxY\",\n    value: function calculateMinMaxY(y) {\n      // Calculate timeline min/max Y for the graphs being shown.\n      var minY = Infinity;\n      var maxY = -Infinity;\n\n      for (var _iterator7 = y, _isArray7 = Array.isArray(_iterator7), _i7 = 0, _iterator7 = _isArray7 ? _iterator7 : _iterator7[Symbol.iterator]();;) {\n        var _ref11;\n\n        if (_isArray7) {\n          if (_i7 >= _iterator7.length) break;\n          _ref11 = _iterator7[_i7++];\n        } else {\n          _i7 = _iterator7.next();\n          if (_i7.done) break;\n          _ref11 = _i7.value;\n        }\n\n        var _y = _ref11;\n\n        if (_y.isShown) {\n          minY = Math.min(minY, _y.min);\n          maxY = Math.max(maxY, _y.max);\n        }\n      } // Min Y is always 0 by design.\n\n\n      minY = 0; // Calculate global min/max Y for the graphs being shown.\n\n      var minYGlobal = Infinity;\n      var maxYGlobal = -Infinity;\n\n      var _loop2 = function _loop2() {\n        if (_isArray8) {\n          if (_i8 >= _iterator8.length) return \"break\";\n          _ref12 = _iterator8[_i8++];\n        } else {\n          _i8 = _iterator8.next();\n          if (_i8.done) return \"break\";\n          _ref12 = _i8.value;\n        }\n\n        var _y = _ref12;\n        var isShown = y.find(function (_) {\n          return _.id === _y.id;\n        }).isShown;\n\n        if (isShown) {\n          minYGlobal = Math.min(minYGlobal, _y.min);\n          maxYGlobal = Math.max(maxYGlobal, _y.max);\n        }\n      };\n\n      for (var _iterator8 = this.data.y, _isArray8 = Array.isArray(_iterator8), _i8 = 0, _iterator8 = _isArray8 ? _iterator8 : _iterator8[Symbol.iterator]();;) {\n        var _ref12;\n\n        var _ret2 = _loop2();\n\n        if (_ret2 === \"break\") break;\n      } // Min Y is always 0 by design.\n\n\n      minYGlobal = 0;\n      return {\n        minY: minY,\n        maxY: maxY,\n        minYGlobal: minYGlobal,\n        maxYGlobal: maxYGlobal\n      };\n    }\n  }, {\n    key: \"updateTimelineBounds\",\n    value: function updateTimelineBounds(from, to) {\n      this.setTimelineWindowLeft(from);\n      this.setTimelineWindowRight(to);\n    }\n  }, {\n    key: \"updateBounds\",\n    value: function updateBounds(from, to) {\n      this.updateTimelineBounds(from, to);\n      this.setState(this.createState(from, to), false);\n    }\n  }, {\n    key: \"createPolylinePoints\",\n    value: function createPolylinePoints(x, y) {\n      // return commaJoin(x, y)\n      return commaJoin(x.map(this.fixSvgCoordinate), y.map(this.fixSvgCoordinate));\n    } // Firefox is buggy with too high and too fractional SVG coordinates.\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var renderTimeline = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      var _this$props3 = this.props,\n          canvasWidth = _this$props3.canvasWidth,\n          gaugeTickMarksCount = _this$props3.gaugeTickMarksCount;\n      var _this$state8 = this.state,\n          minX = _this$state8.minX,\n          maxX = _this$state8.maxX,\n          minY = _this$state8.minY,\n          maxY = _this$state8.maxY,\n          yScale = _this$state8.yScale,\n          xGraphPoints = _this$state8.xGraphPoints,\n          aspectRatio = _this$state8.aspectRatio; // Clear canvas.\n\n      clearElement(this.canvas); // Set canvas `viewBox`.\n\n      this.canvas.setAttribute('viewBox', \"0 0 \".concat(canvasWidth, \" \").concat(this.fixSvgCoordinate(canvasWidth / aspectRatio))); // Calculate grid lines' coordinates.\n\n      var minY_ = minY;\n      var maxY_ = getLowerSiblingDivisibleBy(maxY, 10);\n      var yAxisScale = (maxY - minY) / (maxY_ - minY_);\n      var yAxisTickMarks = divideInterval(minY_, maxY_, gaugeTickMarksCount); // Draw grid lines.\n\n      for (var _iterator9 = yAxisTickMarks, _isArray9 = Array.isArray(_iterator9), _i9 = 0, _iterator9 = _isArray9 ? _iterator9 : _iterator9[Symbol.iterator]();;) {\n        var _ref13;\n\n        if (_isArray9) {\n          if (_i9 >= _iterator9.length) break;\n          _ref13 = _iterator9[_i9++];\n        } else {\n          _i9 = _iterator9.next();\n          if (_i9.done) break;\n          _ref13 = _i9.value;\n        }\n\n        var y = _ref13;\n        this.canvas.appendChild(this.createGridLine(y));\n      } // Draw charts.\n\n\n      for (var _iterator10 = this.state.y, _isArray10 = Array.isArray(_iterator10), _i10 = 0, _iterator10 = _isArray10 ? _iterator10 : _iterator10[Symbol.iterator]();;) {\n        var _ref14;\n\n        if (_isArray10) {\n          if (_i10 >= _iterator10.length) break;\n          _ref14 = _iterator10[_i10++];\n        } else {\n          _i10 = _iterator10.next();\n          if (_i10.done) break;\n          _ref14 = _i10.value;\n        }\n\n        var _ref15 = _ref14,\n            color = _ref15.color,\n            graphPoints = _ref15.graphPoints,\n            isShown = _ref15.isShown;\n\n        // Draw chart.\n        if (isShown) {\n          var graph = document.createElement('polyline');\n          graph.setAttribute('stroke', color);\n          graph.setAttribute('points', this.createPolylinePoints(xGraphPoints.map(this.mapX), graphPoints.map(function (y) {\n            return _this3.mapY(maxY - y * yScale);\n          })).join(' '));\n          graph.classList.add('chartogram__graph');\n          this.canvas.appendChild(graph);\n        }\n      } // A workaround to fix WebKit bug when it's not re-rendering the <svg/>.\n      // https://stackoverflow.com/questions/30905493/how-to-force-webkit-to-update-svg-use-elements-after-changes-to-original\n\n\n      this.canvas.innerHTML += ''; // Draw gauges.\n\n      this.drawGauges(minX, maxX, minY_, maxY_, yAxisScale); // Draw timeline graph.\n\n      if (renderTimeline) {\n        this.renderTimeline();\n      }\n    } // function animateScale(scale) {\n    // \tconsole.log(scale)\n    // \tanimateScaleTo = scale\n    // \tanimateScaleStartedAt = Date.now()\n    // \tpreviousYScale = yScale\n    // \trequestAnimationFrame(animateScaleTick)\n    // }\n    // function animateScaleTick() {\n    // \tconst elapsed = Date.now() - animateScaleStartedAt\n    // \tyScale = previousYScale + (animateScaleTo - previousYScale) * elapsed / 300\n    // \tdrawGraphs(true)\n    // \tif (elapsed < 300) {\n    // \t\trequestAnimationFrame(animateScaleTick)\n    // \t}\n    // }\n\n  }]);\n\n  return Chartogram;\n}();\n\nexport { Chartogram as default };\n//# sourceMappingURL=Chartogram.js.map","import Chartogram from './Chartogram';\nexport default function chartogram(rootNode, data, title, options) {\n  var chartogram = new Chartogram(rootNode, data, title, options);\n  chartogram.componentDidMount();\n  chartogram.render();\n  return function () {\n    chartogram.componentWillUnmount();\n  };\n}\n//# sourceMappingURL=index.js.map"],"names":["_toConsumableArray","arr","Array","isArray","i","arr2","length","_arrayWithoutHoles","iter","Symbol","iterator","Object","prototype","toString","call","from","_iterableToArray","TypeError","_nonIterableSpread","clearElement","element","firstChild","removeChild","renderGaugeLabels","min","max","GAUGE_TICK_MARKS_COUNT","transform","tickMark","document","createElement","value","appendChild","createTextNode","setUpDrag","onDragStart","onDrag","onTouchMove","event","changedTouches","clientX","clientY","onPointerMove","onDragStop","window","removeEventListener","onTouchStart","touches","addEventListener","onPointerDown","_objectSpread","target","arguments","source","ownKeys","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","_slicedToArray","_arrayWithHoles","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","err","_iterableToArrayLimit","_nonIterableRest","_defineProperties","props","descriptor","configurable","writable","defineProperty","obj","Chartogram","rootNode","data","func","interval","timeout","executedAt","scheduled","_this","this","title","options","instance","Constructor","_classCallCheck","setState","aspectRatio","getCanvasAspectRatio","timelineAspectRatio","getTimelineCanvasAspectRatio","onResize","Date","now","remaining","clearTimeout","setTimeout","x","precisionFactor","Math","round","canvasWidth","_this$state","state","minX","maxX","y","_this$state2","minY","maxY","_this$data","_this$state3","minYGlobal","maxYGlobal","_this$state4","yScale","line","classList","add","setAttribute","fixSvgCoordinate","mapX","mapY","yAxisScale","_this$props","gaugeTickMarksCount","months","xAxis","yAxis","timestamp","date","getMonth","getDate","style","height","_this$data2","_this$state5","timelineCanvas","_loop","_isArray","_iterator","_ref","_ref2","id","color","points","find","_","isShown","_simplifyGraph2","simplifyGraph","maxPoints","yMax","apply","threshold","_x","_y","slice","y0","abs","graph","createPolylinePoints","map","mapXForTimeline","mapYForTimeline","join","innerHTML","_ref3","name","toggler","xmlns","check","createElementNS","backgroundCircle","checkCircle","checkMark","calculateMinMaxY","toggle","side","timelineCoordinates","deltaX","handle","timelineWindowLeftHandle","timelineWindowRightHandle","handleWidth","parseFloat","getComputedStyle","timelineWindow","borderLeftWidth","timeline","getBoundingClientRect","timelineWindowCoordinates","left","width","ratio","updateBounds","toRatio","fromRatio","innerX","timelineWindowDrag","timelineOverlayLeft","right","timelineOverlayRight","canvasDimensions","isIndexInBounds","_this$props2","weekdays","onTrack","screenX","xIndex","_this$state6","xPoints","xPoint","xHigherIndex","findIndex","xLowerIndex","removeTooltip","xLower","xHigher","tooltipForX","tooltip","addTooltip","tooltipDate","textContent","getDay","_iterator2","_isArray2","_i2","_ref4","_ref5","tooltipValues","childNodes","xRatio","updateTooltipPoints","updateTooltipLine","onTrackStart","canvas","index","onTrackStop","top","onPointerEnter","tooltipContainer","_iterator3","_isArray3","_i3","_ref6","_ref7","tooltipValue","tooltipName","tooltipLine","setAttributeNS","insertBefore","querySelector","removeTooltipPoints","removeTooltipLine","tooltipPoints","_iterator4","_isArray4","_i4","_ref8","point","canvasWrapper","_iterator5","_isArray5","_i5","_ref9","addTooltipLine","_this$state7","addTooltipPoints","yRatio","bottom","timelineWindowSize","pow","precision","protoProps","staticProps","setUpTimelineWindowHandle","setUpTimelineWindow","setUpCanvasTooltipListener","graphTogglers","_iterator6","_isArray6","_i6","_ref10","createGraphToggler","getInitialState","updateTimelineBounds","onResizeThrottled","timelineCanvasDimensions","newState","renderTimeline","render","fromIndex","_this$data3","createState","toIndex","_this2","xGraphPoints","graphPoints","beforeStartY","startPoint","afterEndY","endY","endPoint","Infinity","_iterator7","_isArray7","_i7","_ref11","_loop2","_isArray8","_i8","_iterator8","_ref12","to","setTimelineWindowLeft","setTimelineWindowRight","a","b","ai","_this3","_this$props3","_this$state8","minY_","maxY_","n","divider","floor","getLowerSiblingDivisibleBy","_iterator9","divideInterval","_isArray9","_i9","_ref13","createGridLine","_iterator10","_isArray10","_i10","_ref14","_ref15","drawGauges","chartogram","componentDidMount","componentWillUnmount"],"mappings":"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"}